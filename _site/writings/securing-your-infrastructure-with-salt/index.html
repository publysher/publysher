<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  <title>Securing your infrastructure with Salt - Publysher</title>

  <meta name="description" content="Provisioning servers on DigitalOcean like a king is one thing, but let’s be honest: default installations don’t provide a lot of security. So I’ve spent some...">

  <meta name="og:title" content="Yigal Duppen">
  <meta name="og:description" content="Provisioning servers on DigitalOcean like a king is one thing, but let’s be honest: default installations don’t provide a lot of security. So I’ve spent some...">
  <meta name="og:site_name" content="Publysher">

  <meta name="twitter:title" content="Yigal Duppen  - Publysher">
  <meta name="twitter:description" content="Provisioning servers on DigitalOcean like a king is one thing, but let’s be honest: default installations don’t provide a lot of security. So I’ve spent some...">
  <meta name="twitter:site" content="@publysher">

  <link rel="stylesheet" href="https://cdn.rawgit.com/barberboy/fira/3.1.1/fira.css">
  <link rel="stylesheet" href="/css/font-awesome.min.css">
  <link rel="stylesheet" href="/css/main.css">


  <link rel="canonical" href="http://localhost:4000/writings/securing-your-infrastructure-with-salt/">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>

  

  
    <script src="http://localhost:35729/livereload.js"></script> 
  

<script src="http://127.0.0.1:35729/livereload.js"></script></head>

<body>
  <main class="main" id="" aria-label="Content">
  	<div class="menu">
	<div class="logo-box"> 
		<a href="/">
			yigal duppen <br> <span>publysher</span> 
		</a>
	</div>
	<nav class="nav">
		<ul>
	    <li class="nav-list">
	      <a href="/projects/" class="nav-link" >
	        <span class="nav-projects">projects</span>
	      </a>
	    </li>
	    <li class="nav-list">
	      <a href="/writings/" class="nav-link"  id="nav-current" >
	        <span class="nav-writings">writings</span>
	      </a>
	    </li>
		</ul>
	</nav>
</div>


  	<div class="writing-box">

		<li class="writing-chapeau oceaan">
			<span  class="padding-left-36">
				Infra as a Repo
			</span>
		</li>
		<h1 class="grijs-40">Securing your infrastructure with Salt</h1>
		<div class="writing-project-writing oceaan">DevOps</div>
	</div>



	<div class="writing-content-box">

		<p>Provisioning servers on DigitalOcean like a king is one thing, but let’s be honest: default installations don’t provide a lot of security. So I’ve spent some time to manage the security on my provisioned boxes. This post (and probably the next as well) will show you how I used SaltStack to secure my infrastructure.
The goal</p>
<div class="highlight"><pre><code class="language-" data-lang="">Given the master/minion set-up from the previous posts, I want to have a running firewall which:

    enables SSH access
    enables minion/master communication
    enables HTTP(S) access
</code></pre></div>
<h3 id="quick-fix">Quick Fix</h3>

<p>The first step was an easy one. In my previous post I introduced a Makefile to create a public-key infrastructure; subsequently, the keys were securely distributed using the salty-vagrant plugin.</p>

<p>Unfortunately, I forgot that the directory in which your Vagrantfile resides is automatically shared over all machines. Which means that in practice, I started out with carefully distributing my secret private keys, only to upload them to all my hosts in the next step.</p>

<p>Luckily, this was easily fixed by the following line in my Vagrantfile:</p>
<div class="highlight"><pre><code class="language-" data-lang="">config.vm.synced_folder 'shared/', '/vagrant/'

</code></pre></div>
<p>Phew.</p>


	</div>

    <div class="footer-box">

	<footer class="footer">

		<div class="footer-yigal">

			<div class="yigal-payoff">
				<a href="/yigalduppen/"><span>Yigal Duppen</span></a> is a driven software architect
			</div>

			
			<div class="footer-publysher">
				<address class="footer-adres">
					<div class="footer-bv"><b>Publysher bv</b></div>
					<div class="footer-name">Yigal Duppen</div>
					<div class="footer-mobile">M +31 (0)6 4007 1736</div>
					<div class="footer-email"><a class="aqua" href="">yigal@publysher.nl</a></div>
				</address>
		    </div>

		    <div class="icons-social">
				<a href="" target="_blank">
			    <span class="fa-stack fa">
				  <i class="fa fa-github fa-stack-2x fa-inverse" style="color:black; font-size: 2em;"></i>
				</span>
				</a>
				
				<a href="" target="_blank">
			    <span class="fa-stack fa">
			        <i class="fa fa-circle fa-stack-2x"></i>
			        <i class="fa fa-linkedin fa-stack-1x fa-inverse" style="font-size: 1.2em;"></i>
			    </span>
				</a>
				<a href="" target="_blank">
			    <span class="fa-stack fa">
			        <i class="fa fa-circle fa-stack-2x"></i>
			        <i class="fa fa-twitter fa-stack-1x fa-inverse" style="font-size: 1.2em;"></i>
			    </span>
				</a>
			</div>


		</div>

	</footer>
</div>

<div class="bottom-line"> 
	<div class="copyright">    
		<p>&copy; 2017 Publysher</p>
	</div>   
    
	<div class="disclaimer">
		<div class="disclaimer-link"><a href="/divroclaimer">proclaimer</a></div>
		<div class="disclaimer-link"><a href="/colofon">colofon</a></div>
	</div>

</div>
  </main>
</body>
</html>

